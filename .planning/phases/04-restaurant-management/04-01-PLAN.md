---
phase: 04-restaurant-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/table.tsx
  - src/components/ui/badge.tsx
  - src/components/ui/button.tsx
  - src/components/ui/input.tsx
  - src/components/ui/select.tsx
  - src/components/ui/label.tsx
  - src/lib/restaurant-context.tsx
  - src/app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "useRestaurants() returns restaurants array, addRestaurant, and removeRestaurant from any component wrapped by RestaurantProvider"
    - "RestaurantProvider initializes state from DEFAULT_RESTAURANTS (19 items)"
    - "Provider is mounted in root layout so state persists across page navigations"
  artifacts:
    - path: "src/lib/restaurant-context.tsx"
      provides: "RestaurantContext provider and useRestaurants hook"
      exports: ["RestaurantProvider", "useRestaurants"]
    - path: "src/app/layout.tsx"
      provides: "Root layout wrapping children with RestaurantProvider"
      contains: "RestaurantProvider"
    - path: "src/components/ui/table.tsx"
      provides: "shadcn Table components"
      exports: ["Table", "TableHeader", "TableBody", "TableHead", "TableRow", "TableCell"]
    - path: "src/components/ui/select.tsx"
      provides: "shadcn Select components"
      exports: ["Select", "SelectContent", "SelectItem", "SelectTrigger", "SelectValue"]
  key_links:
    - from: "src/lib/restaurant-context.tsx"
      to: "src/lib/restaurants.ts"
      via: "imports DEFAULT_RESTAURANTS for initial state"
      pattern: "import.*DEFAULT_RESTAURANTS.*from.*restaurants"
    - from: "src/app/layout.tsx"
      to: "src/lib/restaurant-context.tsx"
      via: "imports and renders RestaurantProvider wrapping children"
      pattern: "RestaurantProvider"
---

<objective>
Install shadcn UI components and create the RestaurantContext provider that shares restaurant state across pages.

Purpose: Phase 4 needs Table, Button, Input, Select, and Label UI components for the restaurant management page. The restaurant list state must live in a React Context provider mounted in the root layout so both the /restaurants page (Phase 4) and the future picker page (Phase 5) share the same mutable data.

Output: Six shadcn UI component files, one RestaurantContext module, and an updated root layout.
</objective>

<execution_context>
@/Users/diamond.hung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/diamond.hung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-restaurant-management/04-RESEARCH.md

@src/lib/types.ts
@src/lib/restaurants.ts
@src/app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn UI components and create RestaurantContext</name>
  <files>
    src/components/ui/table.tsx
    src/components/ui/badge.tsx
    src/components/ui/button.tsx
    src/components/ui/input.tsx
    src/components/ui/select.tsx
    src/components/ui/label.tsx
    src/lib/restaurant-context.tsx
  </files>
  <action>
    1. Run `npx shadcn add table badge button input select label` to install all six shadcn components at once. The command is idempotent — if any exist (e.g., navigation-menu.tsx already present), they are skipped.

    2. Create `src/lib/restaurant-context.tsx` as a Client Component (`'use client'` first line):
       - Import `createContext`, `useContext`, `useState` from `react`
       - Import `Restaurant` type from `./types`
       - Import `DEFAULT_RESTAURANTS` from `./restaurants`
       - Define `RestaurantContextValue` interface with: `restaurants: Restaurant[]`, `addRestaurant: (r: Restaurant) => void`, `removeRestaurant: (id: string) => void`
       - Create context with `createContext<RestaurantContextValue | null>(null)`
       - Export `RestaurantProvider` component that:
         - Holds `useState<Restaurant[]>(DEFAULT_RESTAURANTS)` (spread copy not needed — useState doesn't mutate)
         - Defines `addRestaurant(r)` using `setRestaurants(prev => [...prev, r])`
         - Defines `removeRestaurant(id)` using `setRestaurants(prev => prev.filter(r => r.id !== id))`
         - Renders `<RestaurantContext value={{ restaurants, addRestaurant, removeRestaurant }}>` wrapping children
         - Note: Use `value` prop directly on Context (React 19 pattern), NOT `<Context.Provider value={...}>`
       - Export `useRestaurants()` hook that calls `useContext(RestaurantContext)`, throws if null ("useRestaurants must be used within RestaurantProvider"), otherwise returns the context value
  </action>
  <verify>
    - `ls src/components/ui/table.tsx src/components/ui/badge.tsx src/components/ui/button.tsx src/components/ui/input.tsx src/components/ui/select.tsx src/components/ui/label.tsx` all exist
    - `ls src/lib/restaurant-context.tsx` exists
    - `npx tsc --noEmit` passes with no type errors
  </verify>
  <done>
    Six shadcn UI components installed. RestaurantContext module exports RestaurantProvider and useRestaurants hook with correct types.
  </done>
</task>

<task type="auto">
  <name>Task 2: Mount RestaurantProvider in root layout</name>
  <files>src/app/layout.tsx</files>
  <action>
    Modify `src/app/layout.tsx`:
    1. Add import: `import { RestaurantProvider } from '@/lib/restaurant-context'`
    2. Wrap the `<main>` element (including its children) with `<RestaurantProvider>`:
       ```
       <RestaurantProvider>
         <main className="min-h-screen">{children}</main>
       </RestaurantProvider>
       ```
    3. Keep `<Header />` OUTSIDE the provider (Header is a Server Component and does not need restaurant state)
    4. Keep layout.tsx as a Server Component — do NOT add 'use client'. A Server Component can import and render a Client Component (RestaurantProvider) without itself becoming a Client Component. This is standard Next.js App Router behavior.
    5. Preserve all existing code: metadata export, font imports, Geist font variables, html lang="zh-TW", body className.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `npm run build` completes without errors
  </verify>
  <done>
    Root layout wraps page content with RestaurantProvider. Any page component can call useRestaurants() to access shared restaurant state. Build passes.
  </done>
</task>

</tasks>

<verification>
- All six shadcn UI component files exist in src/components/ui/
- src/lib/restaurant-context.tsx exports RestaurantProvider and useRestaurants
- src/app/layout.tsx imports and renders RestaurantProvider around {children}
- `npm run build` succeeds with zero errors
</verification>

<success_criteria>
- shadcn Table, Badge, Button, Input, Select, Label components are available for import
- RestaurantProvider is mounted in root layout
- useRestaurants hook is importable and typed correctly
- Build passes cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/04-restaurant-management/04-01-SUMMARY.md`
</output>
