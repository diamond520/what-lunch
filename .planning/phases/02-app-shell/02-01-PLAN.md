---
phase: 02-app-shell
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/navigation-menu.tsx
  - src/components/layout/header.tsx
  - src/components/layout/nav-links.tsx
  - src/app/restaurants/page.tsx
autonomous: true

must_haves:
  truths:
    - "NavigationMenu shadcn component is available for import at @/components/ui/navigation-menu"
    - "Header Server Component renders the app name and NavLinks without 'use client'"
    - "NavLinks Client Component uses usePathname() to highlight the active route"
    - "A /restaurants route exists and renders a placeholder page with the shared header"
  artifacts:
    - path: "src/components/ui/navigation-menu.tsx"
      provides: "shadcn NavigationMenu, NavigationMenuList, NavigationMenuItem, NavigationMenuLink, navigationMenuTriggerStyle"
      min_lines: 50
    - path: "src/components/layout/header.tsx"
      provides: "Header Server Component"
      contains: "export function Header"
    - path: "src/components/layout/nav-links.tsx"
      provides: "NavLinks Client Component with active state"
      contains: "'use client'"
    - path: "src/app/restaurants/page.tsx"
      provides: "/restaurants route placeholder"
      contains: "export default function RestaurantsPage"
  key_links:
    - from: "src/components/layout/nav-links.tsx"
      to: "src/components/ui/navigation-menu.tsx"
      via: "named import"
      pattern: "from '@/components/ui/navigation-menu'"
    - from: "src/components/layout/nav-links.tsx"
      to: "usePathname"
      via: "next/navigation hook"
      pattern: "usePathname"
    - from: "src/components/layout/header.tsx"
      to: "src/components/layout/nav-links.tsx"
      via: "import NavLinks"
      pattern: "from './nav-links'"
---

<objective>
Install the shadcn NavigationMenu component and create the navigation layer: a Header Server Component wrapping a NavLinks Client Component, plus a /restaurants placeholder page.

Purpose: Establishes the persistent navigation chrome that both pages share. All files created here are new — no existing files modified — keeping this plan fully autonomous and independent.
Output: navigation-menu.tsx (shadcn), header.tsx, nav-links.tsx, restaurants/page.tsx
</objective>

<execution_context>
@/Users/diamond.hung/.claude/get-shit-done/workflows/execute-plan.md
@/Users/diamond.hung/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-app-shell/02-RESEARCH.md
@src/lib/utils.ts
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn navigation-menu component</name>
  <files>src/components/ui/navigation-menu.tsx</files>
  <action>
Run the shadcn CLI to copy the navigation-menu component into the project:

```bash
npx shadcn add navigation-menu
```

This writes `src/components/ui/navigation-menu.tsx` (shadcn v3 new-york style). No new npm packages are installed — radix-ui is already in package.json.

Confirm the file exists and exports at minimum: NavigationMenu, NavigationMenuList, NavigationMenuItem, NavigationMenuLink, and navigationMenuTriggerStyle. Do not edit the generated file.
  </action>
  <verify>
Run: `grep -n "navigationMenuTriggerStyle" /Users/diamond.hung/ailabs/code/what-lunch/src/components/ui/navigation-menu.tsx`
Expected: line with `export function navigationMenuTriggerStyle` (or `export const navigationMenuTriggerStyle`)
  </verify>
  <done>src/components/ui/navigation-menu.tsx exists and exports navigationMenuTriggerStyle.</done>
</task>

<task type="auto">
  <name>Task 2: Create NavLinks Client Component with active-state highlighting</name>
  <files>src/components/layout/nav-links.tsx</files>
  <action>
Create directory `src/components/layout/` if it does not exist.

Create `src/components/layout/nav-links.tsx` as a Client Component:

```typescript
'use client'

import Link from 'next/link'
import { usePathname } from 'next/navigation'
import {
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuLink,
  navigationMenuTriggerStyle,
} from '@/components/ui/navigation-menu'
import { cn } from '@/lib/utils'

const NAV_ITEMS = [
  { href: '/', label: '今日推薦' },
  { href: '/restaurants', label: '餐廳管理' },
] as const

export function NavLinks() {
  const pathname = usePathname() ?? '/'

  return (
    <NavigationMenu>
      <NavigationMenuList>
        {NAV_ITEMS.map(({ href, label }) => (
          <NavigationMenuItem key={href}>
            <NavigationMenuLink
              asChild
              className={cn(
                navigationMenuTriggerStyle(),
                pathname === href && 'bg-accent text-accent-foreground'
              )}
            >
              <Link href={href}>{label}</Link>
            </NavigationMenuLink>
          </NavigationMenuItem>
        ))}
      </NavigationMenuList>
    </NavigationMenu>
  )
}
```

Critical patterns from RESEARCH.md to follow exactly:
- `'use client'` at the top (required for usePathname)
- `NavigationMenuLink asChild` wrapping `<Link href="...">` — NOT legacyBehavior/passHref pattern
- `usePathname() ?? '/'` null guard
- `cn()` from `@/lib/utils` for class merging (tailwind-merge prevents duplicate bg-* conflict)
- NAV_ITEMS defined as `as const` for type safety
  </action>
  <verify>
Run: `npx tsc --noEmit` in /Users/diamond.hung/ailabs/code/what-lunch
Expected: exits 0 with no errors related to nav-links.tsx
  </verify>
  <done>src/components/layout/nav-links.tsx exists, uses 'use client', imports NavigationMenuLink with asChild pattern, usePathname for active state detection.</done>
</task>

<task type="auto">
  <name>Task 3: Create Header Server Component and restaurants page placeholder</name>
  <files>
    src/components/layout/header.tsx
    src/app/restaurants/page.tsx
  </files>
  <action>
Create `src/components/layout/header.tsx` as a Server Component (no "use client" directive):

```typescript
import { NavLinks } from './nav-links'

export function Header() {
  return (
    <header className="sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60">
      <div className="container mx-auto flex h-14 max-w-screen-2xl items-center px-4">
        <span className="mr-6 font-semibold text-foreground">What Lunch?</span>
        <NavLinks />
      </div>
    </header>
  )
}
```

Key constraint: NO `'use client'` in this file. The interactive part lives in NavLinks only. The sticky header with backdrop-blur uses shadcn/ui's recommended chrome pattern.

---

Create `src/app/restaurants/page.tsx` as the /restaurants route placeholder:

```typescript
export default function RestaurantsPage() {
  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-2xl font-semibold">餐廳管理</h1>
      <p className="mt-2 text-muted-foreground">餐廳管理功能即將在 Phase 4 推出。</p>
    </div>
  )
}
```

This is a Server Component placeholder. Phase 4 will replace the body with the full management UI. The shared Header is inherited from the root layout — do NOT add a Header here.
  </action>
  <verify>
Run: `npx tsc --noEmit` in /Users/diamond.hung/ailabs/code/what-lunch
Expected: exits 0 with no TypeScript errors.
Run: `grep -n "'use client'" /Users/diamond.hung/ailabs/code/what-lunch/src/components/layout/header.tsx`
Expected: no output (header.tsx must NOT have "use client")
  </verify>
  <done>header.tsx exists without "use client" and imports NavLinks. src/app/restaurants/page.tsx exists as a valid Server Component placeholder.</done>
</task>

</tasks>

<verification>
After all three tasks:
1. `src/components/ui/navigation-menu.tsx` — shadcn component file, exports navigationMenuTriggerStyle
2. `src/components/layout/nav-links.tsx` — has 'use client', usePathname, NavigationMenuLink asChild pattern
3. `src/components/layout/header.tsx` — no 'use client', imports NavLinks
4. `src/app/restaurants/page.tsx` — Server Component placeholder
5. `npx tsc --noEmit` exits 0 across the whole project
</verification>

<success_criteria>
- All 4 files exist at the expected paths
- TypeScript strict mode passes (npx tsc --noEmit exits 0)
- header.tsx has no "use client" directive
- nav-links.tsx has "use client" and uses usePathname
- NavigationMenuLink uses asChild pattern (not legacyBehavior)
</success_criteria>

<output>
After completion, create `.planning/phases/02-app-shell/02-01-SUMMARY.md` using the summary template.
</output>
